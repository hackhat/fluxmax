var Fluxmax=function(n){function t(r){if(e[r])return e[r].exports;var i=e[r]={exports:{},id:r,loaded:!1};return n[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var e={};return t.m=n,t.c=e,t.p="",t(0)}([function(n,t,e){n.exports={App:e(4),StoreMixin:e(6)}},function(n){n.exports=lodash},function(n,t,e){var r=e(1),i=function(n){r.isArray(n)?(this.__changeTypes={},n.forEach(function(n){this.__changeTypes[n]=!0}.bind(this))):this.__changeTypes=n};r.extend(i.prototype,{get:function(n){if(!this.exists(n))throw new Error('Change "'+n+'" does not exist.');return n},validateData:function(n,t){var e=this.__getSchema(n);if(e===!0)return{data:"NO_SCHEMA"};if(void 0===e)return{data:"NO_TYPE_DEFINED"};var r=new Validator(e);return{data:r.check(t)}},__getSchema:function(n){return this.__changeTypes[n]},exists:function(n){return"*"===n?!0:!!this.__changeTypes[n]},getAll:function(){return r.keys(this.__changeTypes)}}),n.exports=i},function(n,t,e){var r=e(1),i=function(n){n=r.extend({},n),this.__listenersBySrc={},this.__dependenciesBySrc={},this.__dependencies=[],this.__changes=[]};r.extend(i.prototype,{on:function(n,t,e,r,i,o){if(!r)throw new Error("runCb is required");this.__listenersBySrc[t]||(this.__listenersBySrc[t]={}),this.__listenersBySrc[t][e]||(this.__listenersBySrc[t][e]=[]);var u={callerSrc:n,targetSrc:t,targetType:e,runCb:r,cbName:i,target:o};this.__listenersBySrc[t][e].push(u),this.__dependenciesBySrc[n]||(this.__dependenciesBySrc[n]={}),this.__dependenciesBySrc[n][t]||(this.__dependenciesBySrc[n][t]=[]),this.__dependenciesBySrc[n][t].push(e),this.__dependencies.push(u)},off:function(n,t,e,i,o,u){var a={callerSrc:n,targetSrc:t,targetType:e,runCb:i,cbName:o,target:u};this.__listenersBySrc[t][e]=this.__listenersBySrc[t][e].filter(function(n){return!r.isEqual(n,a)}),this.__dependenciesBySrc[n][t]=this.__dependenciesBySrc[n][t].filter(function(n){return!r.isEqual(n,e)}),this.__dependencies=this.__dependencies.filter(function(n){return!r.isEqual(n,a)})},emitChangeToListeners:function(n){var t=[];if(this.__changes.push(n),this.__listenersBySrc[n.src]){var e=this.__listenersBySrc[n.src][n.type]||this.__listenersBySrc[n.src]["*"];e&&e.forEach(function(e){t.push(e),e.runCb.call(e.target,n.data)})}return t},clearChanges:function(){this.__changes=[]},getChanges:function(){return this.__changes},getDependencies:function(){return this.__dependencies.slice(0)},renderDependecies:function(n){console.group("Dependencies "+n+":");var t=[],e=[],i={};r.forEach(this.__dependenciesBySrc,function(n,i){r.forEach(n,function(n,r){e.push({entity:i,dependsOn:r,types:n}),n.forEach(function(n){t.push({entity:i,dependsOn:r,type:n})})})}),r.forEach(this.__dependenciesBySrc,function(n,t){i[t]={deps:e.reduce(function(n,e){return n+(e.entity===t?1:0)},0),depsArray:e.reduce(function(n,e){return e.entity===t&&n.push(e.dependsOn+"("+e.types.join(", ")+")"),n},[]).join(", ")}}),console.log("All:"),console.table(t),console.log("Depends on:"),console.table(i),console.groupEnd()}}),n.exports=i},function(n,t,e){var r=e(1),i=e(3),o=e(5),u=e(2),a=function(n){n=r.extend({isSingleton:!1},n),this.__isSingleton=n.isSingleton,this.__eachChange=new i,this.__batchChange=new i,this.__entities=[],this.__entitiesById={},this.__changeTypesByEntityId={},this.__metaEntities=[]};a.ChangeTypes=u,a.__instance=void 0,a.getInstance=function(){return a.__instance||(a.__instance=new a({isSingleton:!0})),a.__instance},a.listen=function(n,t){var e=new o(n,t);return e.start(a.getInstance(),e.createMockObject()),e},a.addMetaEntity=function(n){var t=a.listen(n.id,n.listeners),e=a.getInstance();return e.setEntityChangeTypes(n.id,n.changeTypes),e.addMetaEntity(n),t},a.renderDependencies=function(){a.getInstance().renderDependencies()},a.checkDependencies=function(){a.getInstance().checkDependencies()},r.extend(a.prototype,{addEntities:function(n){n.forEach(function(n){var t=n.getEntityId();if(!t)return console.log("No entity id");if(this.__entitiesById[t])throw new Error('Entity "'+t+'" already exists.');this.__entities.push(n),this.__entitiesById[t]=n;var e=this.__onEntityChange.bind(this,t);n.on("change",e),this.setEntityChangeTypes(t,n.getChangeTypes())}.bind(this))},addMetaEntity:function(n){this.__metaEntities.push(n)},setEntityChangeTypes:function(n,t){this.__changeTypesByEntityId[n]=new u(t)},renderDependencies:function(){this.__eachChange.renderDependecies("each"),this.__batchChange.renderDependecies("batch"),console.group("Entities");var n=r.sortBy(this.__metaEntities,"id");n.forEach(function(n){console.log("%c"+n.id+": "+new u(n.changeTypes).getAll().join(", "),"color: green")}),console.groupEnd()},checkDependencies:function(){var n=this.__eachChange.getDependencies();n=n.map(function(n){return r.extend({},n,{depType:"each"})});var t=this.__batchChange.getDependencies();t=t.map(function(n){return r.extend({},n,{depType:"batch"})});var e=r.sortBy(n.concat(t),["callerSrc","targetSrc","type"]),i=[],o=[];e.forEach(function(n){var t=this.__changeTypesByEntityId[n.targetSrc],e='Dependency defined in "'+n.callerSrc+'" on "'+n.targetSrc+'" at type "'+n.targetType+'" is ',r=!0;t&&t.exists(n.targetType)||(r=!1);var u=" ["+n.depType+"]";r?o.push(e+"valid."+u):i.push(e+"not valid."+u)}.bind(this)),console.group("Errors"),i.forEach(function(n){console.log("%c"+n,"color: red")}),0===i.length&&console.log("%c No errors!","color: green"),console.groupEnd(),console.group("Valid"),o.forEach(function(n){console.log("%c"+n,"color: green")}),console.groupEnd()},onEach:function(n,t,e,r,i,o){this.__eachChange.on(n,t,e,r,i,o)},onBatch:function(n,t,e,r,i,o){this.__batchChange.on(n,t,e,r,i,o)},offEach:function(n,t,e,r,i,o){this.__eachChange.off(n,t,e,r,i,o)},offBatch:function(n,t,e,r,i,o){this.__batchChange.off(n,t,e,r,i,o)},__onEntityChange:function(n,t){if(!n||!t)throw new Error("entityId or changePayload is missing");var e={src:n,type:t.type,data:t.data};this.__eachChange.emitChangeToListeners(e)},injectChange:function(n,t,e){this.__onEntityChange(n,{type:t,data:e})},emitBatchChanges:function(){var n=this.__eachChange.getChanges();if(0!==n.length){this.__eachChange.clearChanges();var t={};n.forEach(function(n){var e=n.src,r=n.type;t[e]||(t[e]={}),t[e][r]||(t[e][r]=[]),t[e][r].push(n)});var e=0,i=[];r.forEach(t,function(n,t){r.forEach(n,function(n,r){var o={src:t,type:r,data:n},u=this.__batchChange.emitChangeToListeners(o);i.push({payload:o,listeners:u}),e++}.bind(this))}.bind(this))}}}),n.exports=a},function(n,t,e){var r=e(1),i=function(n,t){this.__entityId=n,this.__items=t};i.noop=function(){},r.extend(i.prototype,{start:function(n,t){this.__startOrEnd("start",n,t)},end:function(n,t){this.__startOrEnd("end",n,t)},createMockObject:function(){var n={};return this.__items.forEach(function(t){var e=t[3];n[e]=i.noop}),n},__startOrEnd:function(n,t,e){this.__items.forEach(function(r){var i,o=r[0],u=r[1],a=r[2],c=r[3];if("batch"===o)if("start"===n)i=t.onBatch;else{if("end"!==n)throw new Error("Type not available.");i=t.offBatch}else{if("each"!==o)throw new Error("ListenTtype not available.");if("start"===n)i=t.onEach;else{if("end"!==n)throw new Error("Type not available.");i=t.offEach}}if(!e[c])throw new Error('Cant find method "'+c+'" on entity "'+this.__entityId+'".');i.call(t,this.__entityId,u,a,e[c],c,e)}.bind(this))}}),n.exports=i},function(n){n.exports={mount:function(n){return this.Class?void this.Class.listen.start(n,this):console.log("This store is missing Class.")},getEntityId:function(){return this.Class?this.Class.meta.id:console.log("This store doesnt have this.Class")},getChangeTypes:function(){return this.Class?this.Class.meta.changeTypes:console.log("This store doesnt have this.Class")},emitChange:function(n,t){this.emit("change",{type:n,data:t})}}}]);